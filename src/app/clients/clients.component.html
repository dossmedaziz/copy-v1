<div class="card">
 
    <p-toolbar styleClass="p-mb-4">
        <ng-template pTemplate="left">
            <button pButton pRipple label="New" icon="pi pi-plus" class="p-button-success p-mr-2    p-button-rounded" (click)="showModalDialog3()"></button>
            <button pButton (click)="deleteClients()" pRipple label="Delete" icon="pi pi-trash" class="p-button-danger p-mr-2 p-button-rounded"[disabled]="!selectedClients || !selectedClients.length"></button>

        </ng-template>

        <ng-template pTemplate="right">
                      
                       <button pButton pRipple label="Export" icon="pi pi-file-pdf" (click)="exportPdf()" style="background-color: #34495E;border: none;" [disabled]="!selectedUsers || !selectedUsers.length"></button>
        </ng-template>
    </p-toolbar>



    <p-table [value]="clients" dataKey="id" [(selection)]="selectedClients">
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 3rem">
                    <p-tableHeaderCheckbox></p-tableHeaderCheckbox> 
                </th>
                <th style="width: 3rem"></th>
                <th pSortableColumn="name"> Client Name <p-sortIcon field="name"></p-sortIcon></th>
                <th pSortableColumn="email"> Email <p-sortIcon field="email"></p-sortIcon></th>
                <th pSortableColumn="matFisc"> MatFisc <p-sortIcon field="matFisc"></p-sortIcon></th>
                <th pSortableColumn="address"> Address <p-sortIcon field="address"></p-sortIcon></th>
                <th pSortableColumn="fax"> Fax <p-sortIcon field="fax"></p-sortIcon></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-client let-expanded="expanded">
            <tr>
                <td>
                    <p-tableCheckbox [value]="client"></p-tableCheckbox>
                </td>
                <td>
                    <button type="button" pButton pRipple [pRowToggler]="client" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                </td>
                
                <td>{{client.client_name}}</td>
                <td>{{client.email}}</td>
                <td>{{client.matFisc}}</td>
                <td>{{client.address}}</td>
                <td>{{client.fax}}</td>
               
                <td>
                    <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success p-mr-2" (click)="getSelectedClient(client)"></button>
                    <button pButton pRipple icon="pi pi-info-circle" class="p-button-rounded p-button-secondary p-mr-2"(click)="ShowUser(user)"></button>
                    <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-warning " (click)="showModalDialog4()"></button>

                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-client>
            <tr>
                <td colspan="7">
                    <div class="p-p-3">
                        <p-table [value]="client.contact" dataKey="id">
                            <ng-template pTemplate="header">
                                <tr>
              <th pSortableColumn="project_name"> Contact Name <p-sortIcon field="project_name"></p-sortIcon></th>
              <th pSortableColumn="start_date"> Position <p-sortIcon field="start_date"></p-sortIcon></th>
              <th pSortableColumn="status"> Phone <p-sortIcon field="status"></p-sortIcon></th>
              <th pSortableColumn="status"> Email <p-sortIcon field="status"></p-sortIcon></th>
              <th pSortableColumn="status"> Note <p-sortIcon field="status"></p-sortIcon></th>
                                   
                                    <th style="width: 4rem"></th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-contact>
                                <tr>
                                    <td>{{contact.contact_name}}</td>
                                    <td>{{contact.position}}</td>
                                    <td>{{contact.phone}}</td>
                                    <td>{{contact.email}}</td>
                                    <td>{{contact.description}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="6">There are no order for this product yet.</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>

</div>


<!-- Modal for  editing-->
<p-dialog header="Update Client" [(visible)]="displayModal" [modal]="true"[style]="{ width: '120vh','height':'80vh  ' }"[baseZIndex]="10000" 
  [draggable]="false"  [resizable]="false" styleClass="p-fluid">
  <div class="p-fluid">
    <img class="center" src="assets/img/add_person_user_icon_131752.ico" />
    <br />

    <form [formGroup]="clientForm">

      <div class="p-grid p-fluid">  
<div class="p-field p-col-6 " >
   <span class="p-float-label" >
    <input id="name" type="text" pInputText class="brad" formControlName="client_name"> 
    <label for="name">Client Name</label>
  </span>
</div>


<div class="p-field p-col-6 ">
  
  <span class="p-float-label" >
    <input id="email" type="text" pInputText class="brad" formControlName="email"
    > 
    <label for="email"> Email</label>
  </span>
      </div>
    </div>
    
    
    <div class="p-grid p-fluid">  
       <div class="p-field p-col-6">      
        <span class="p-float-label" >
          <input id="phone" type="text" pInputText class="brad" formControlName="phone"> 
          <label for="phone">Phone</label>
        </span>
  </div>
       
      
      <div class="p-field p-col-6 " >      
        <span class="p-float-label" >
          <input id="fax" type="text" pInputText class="brad" formControlName="fax"> 
          <label for="fax">Fax</label>
        </span>
        </div>
    </div>

    <div class="p-grid p-fluid">  

      <div class="p-field p-col-6 ">
  
        <span class="p-float-label" >
          <input id="matFisc" type="text" pInputText class="brad"  formControlName="matFisc"
          > 
          <label for="matFisc">MatFisc</label>
        </span>
            </div>
    <div class="p-field p-col-6">      
          <span class="p-float-label" >
            <input id="address" type="text" pInputText class="brad" formControlName="address"> 
            <label for="address">Address</label>
          </span>
    </div>
  </div>




  <div *ngIf="vis">
    <div class="p-field p-col-6">      
      <span class="p-float-label" >
        <input id="address" type="text" pInputText class="brad"> 
        <label for="address">Address</label>
      </span>
</div>

  </div>
 


    </form>




  <button class="btn btn-outline-primary" (click)="test()">add Contacts</button>

  </div>
  
  <ng-template pTemplate="footer">


    <p-button icon="pi pi-times" (click)="displayModal = false" label="Cancel" styleClass="p-button-text" ></p-button>
    <p-button icon="pi pi-check" (click)="updateUser()" label="Save" styleClass="p-button-text" ></p-button>
</ng-template>

</p-dialog>


<!-- Modal More info-->

<p-dialog header="More Info" [(visible)]="displayModal1" [modal]="true" [style]="{ width: '650px' }" [baseZIndex]="10000"[draggable]="true"[resizable]="true">
    <img class="center"  src="assets/img/cog_tools_configuration_settings_icon_131758.ico"/>
    <br />
  <div *ngFor="let user of selectedUser">
    <h1>name: {{ user.name }}</h1>
    <h1>age: {{ user.age }}</h1>
  </div>
  
    <ng-template pTemplate="footer">
      <p-button icon="pi pi-check"  (click)="displayModal1 = false" label="Ok" styleClass="p-button-text"></p-button>
    </ng-template>
  </p-dialog>
  



<!-- Modal add new Client-->

<p-dialog header="Add new Client" [(visible)]="displayModal3" [modal]="true"[style]="{ width: '150vh','height':'100vh' }"[baseZIndex]="10000" 
  [draggable]="false"  [resizable]="false" styleClass="p-fluid">
  <div class="p-fluid">
    <img class="center" src="assets/img/add_person_user_icon_131752.ico" />
    <br />

    <form [formGroup]="clientForm" >

      <div class="p-grid p-fluid">  
<div class="p-field p-col-6 " >
   <span class="p-float-label" >
    <input id="name" type="text" pInputText class="brad" formControlName="client_name"> 
    <label for="name">Client Name</label>
  </span>
</div>


<div class="p-field p-col-6 ">
  
  <span class="p-float-label" >
    <input id="email" type="text" pInputText class="brad" formControlName="email"
    > 
    <label for="email"> Email</label>
  </span>
      </div>
    </div>
    
    
    <div class="p-grid p-fluid">  
       <div class="p-field p-col-6">      
        <span class="p-float-label" >
          <input id="phone" type="text" pInputText class="brad" formControlName="phone"> 
          <label for="phone">Phone</label>
        </span>
  </div>
       
      
      <div class="p-field p-col-6 " >      
        <span class="p-float-label" >
          <input id="fax" type="text" pInputText class="brad" formControlName="fax"> 
          <label for="fax">Fax</label>
        </span>
        </div>
    </div>

    <div class="p-grid p-fluid">  

      <div class="p-field p-col-6 ">
  
        <span class="p-float-label" >
          <input id="matFisc" type="text" pInputText class="brad"  formControlName="matFisc"
          > 
          <label for="matFisc">MatFisc</label>
        </span>
            </div>
    <div class="p-field p-col-6">      
          <span class="p-float-label" >
            <input id="address" type="text" pInputText class="brad" formControlName="address"> 
            <label for="address">Address</label>
          </span>
    </div>
 


            </div>


      



    </form>
  </div>
  <ng-template pTemplate="footer">

    <p-button icon="pi pi-times" (click)="displayModal = false" label="Cancel" styleClass="p-button-text"></p-button>
      <p-button icon="pi pi-check" (click)="addClient()" label="Save" styleClass="p-button-text"></p-button>
  </ng-template>
</p-dialog>







<!--Modal for Preview -->

<p-dialog header="Preview" [(visible)]="displayModal4" [modal]="true" [style]="{width: '50vw'}" [baseZIndex]="10000"
    [draggable]="false" [resizable]="false">
    
<div class="p-fluid">
    Preview for the Bill
    
</div>

        <ng-template pTemplate="footer">
            <p-button icon="pi pi-check" (click)="displayModal4=false" label="Ok" styleClass="p-button-text"></p-button>
            
        </ng-template>
</p-dialog>


